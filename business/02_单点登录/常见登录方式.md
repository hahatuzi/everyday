# 一：跨域的理解
  ### 1.概念
  跨域的定义主要基于浏览器的同源策略（Same-Origin Policy）。根据同源策略，跨域是指当前页面的源（origin）与目标资源的源不同。具体来说：
  源（origin）的定义：源由协议（protocol）、域名（domain）和端口（port）三部分组成.
  跨域的情况：当一个请求的目标资源的协议、域名或端口与当前页面的源不同时，就会发生跨域.

  ### 2.具体判断标准
  - (1)协议不同：如 http 和 https
  - (2)域名不同：如 example.com 和 sub.example.com
  - (3)端口不同：如 example.com:8080 和 example.com:8081
  - (4)特殊情况：**子域名之间也被视为跨域**，如 a.example.com 和 b.example.com, **IP 地址和对应的域名之间也被视为跨域**

  ### 3.同源策略的目的：保护用户隐私和数据安全，防止恶意网站通过脚本访问其他网站的敏感数据.
  ### 4.跨域限制：主要体现在 JavaScript 的 XMLHttpRequest 和 Fetch API 等网络请求，以及对 DOM 的访问限制.
  ### 5.cookie的作用域:
  - cookie遵守同站策略，而非同源策略,虽然根据同源策略，不同端口应该被视为不同的源，**但是实际浏览器实现中，cookie是区分域而不区分端口的！！！**
  - 同一个IP域名但是**不同的端口**可以共享cookie！比如本地同时启动两个项目的时候，就会发现cookie是可以共享的
  - **cookie的作用域取决于domain和path,与协议和端口无关**
  - domain:当前域或者父域或者IP地址
  - path
  - secure:规定cookie只能被https传输，防止了http和https之间的cookie共享
  - httpOnly属性
  - expires和max-age定义了cookie的生命周期，默认情况下cookie是session级别的，即退出浏览器后自动过期，max-age是http1.1的产物优先级高于expires，max-age多少秒后过期，expires
  [!参考文章--cookie指南]https://zhuanlan.zhihu.com/p/652236393

# 二：常见的单点登录方式
  ### 1.Session + cookie模式
  - 优点：认证中心验证所有用户的登录，**用户违规时**直接清除掉认证中心对应的用户session即可
  - 缺点：session**用户存储量过大**时需要做**session集群**，如果**认证中心挂了**整个系统都无法登陆
  - 使用方式：用户访问系统A/系统B  --> 未登录 -->  跳转至登录认证中心 ---> cookie --> 系统A/系统B

  ### 2.token
  - 优点：**各系统可以自行验证用户的登录**，认证中心只管生成token,无需维护session
  - 缺点：认证中心丧失控制权
  - 使用方式：用户访问系统A/系统B  --> 未登录 -->  跳转至登录认证中心 ---> token --> 系统A/系统B

  ### 3.OAuth第三方登录:详情转oAuth.md文件

  ### 4.各系统在同一域名下，使用本地浏览器cookie共享数据
    ```js
      // ========同一域名下，可以共享cookie的数据============
      // 应用1的login
      onMounted(() => {
        window.open("http://ippc.pudong.sh:80/", "_self",null,false)
      })
      // 总登录入口应用负责实现登录和cookie的存储，并重定向至子应用的页面
      this.$router.push({ path: this.redirect || '/' })
    ```

  ### 5.多因素认证
    用户输入名字和密码 --> 名字密码无误后再提供验证码或者指纹等二次认证因素 --> 完成认证

  ### 6.SSO单点登录详细实现流程
    单点登录可以从两个步骤去分析具体实现：
    ##### 第一步：**各系统是否可以共享登录信息？**
      - 是否可以共享登录信息决定了各系统是否需要**各自输入用户信息去认证中心获取登录凭证**。
      - 如果**各系统在同一域名下**，那么可以通过**localStorage或者cookie**实现共享token等用户登录信息，系统B就可以使用系统A的登录信息，从而减少登录认证次数。
      - 否则各系统就需要**各自填写用户信息**跳转至登录认证中心获取统一发放的token。或者通过**localStorage跨域**的方式实现共享登录状态
    ##### 第二步：具体的登录凭证生成方式：
      - (1)session + cookie模式:
      用户访问系统A/系统B  --> 未登录 -->  跳转至登录认证中心 ---> cookie --> 系统A/系统B
      - (2)token模式:
      用户访问系统A/系统B  --> 未登录 -->  跳转至登录认证中心 ---> token --> 系统A/系统B
      - (3)双token模式
      用户访问系统A/系统B  --> 未登录 -->  跳转至登录认证中心 ---> token和refresh --> 系统A/系统B  --> refreshToken(token失效)  -->  认证中心  --> 新的token和refreshToken --> 系统A/系统B
      - (4)JWT
      JWT是一种特殊的token，由header,payload,signature组成
        ```js
          // header:令牌类型JWT,散列算法
          // payload: 
        ```
