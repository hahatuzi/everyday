# 小程序和H5的对比
### 一：宿主环境区别
H5的宿主环境是浏览器。
但是小程序的运行在APP上，它的依赖则是基于浏览器内核重构的内置解析器，并非一个完整的浏览器。它无法使用浏览器的window和document对象。
### 二：运行和更新
小程序的启动包括冷启动和热启动，而H5页面则是打开即为运行。更新类似，小程序的更新需要重新冷启动或者使用自身的API来监听。
### 三：开发语言
### 四：系统权限方面
H5最被诟病的地方在哪？系统权限不够，比如网络通信状态、数据缓存能力、通讯录、或调用硬件的，如蓝牙功能等等一些APP有的功能，H5就没有这些系统权限，因为它重度依赖浏览器能力
依旧是微信小程序举例，微信客户端的这些系统级权限都可以和微信小程序无缝衔接，官方宣称拥有 Native App 的流畅性能
### 五：渲染机制方面
H5就是 web 渲染，浏览器渲染
微信小程序的宿主环境是微信，宿主环境为了执行小程序的各种文件：wxml文件、wxss文件、js文件，提供了双线模型 ，什么是双线程模型呢，先看一张官方图

小程序的渲染层和逻辑层分别由2个线程管理

渲染层：界面渲染相关的任务全都在 WebView 线程里执行，一个小程序存在多个界面，所以渲染层存在多个 WebView线程
逻辑层：一个单独的线程执行 JavaScript，在这个环境下执行的都是有关小程序业务逻辑的代码，就是通过图中的 JsCore 线程来运行 JS 脚本
这两个线程都会经过微信客户端( Native )中的 WeixinJsBridage 进行中转通信，逻辑层把数据变化通知到视图层，触发视图层页面更新，视图层把触发的事件通知到逻辑层进行业务处理

小程序的渲染逻辑

在渲染层将 WXML 先转换为 js 对象也就是虚拟 DOM
在逻辑层将虚拟 DOM 对象生成真实 DOM 树，交给渲染层渲染
当视图有数据需更新时，逻辑层调用小程序宿主环境提供的 setData 方法将数据从逻辑层传递到渲染层
经过对比前后差异 ( diff算法 )，把差异应用在真实的 Dom 树上，渲染出正确的 UI 界面完成视图更新

虽然小程序是通过 Native 原生渲染的，但是小程序也支持web渲染，就是 web-view 组件，在 web-view 中加载 H5 页面，而我们开发小程序时，通常会使用 hybrid 的方式，根据具体情况选择部分功能用小程序原生的代码来开发，部分功能通过 web-view 加载 H5 页面来实现，Native 与 Web 渲染 混合使用，实现项目最优解

作者：isboyjc
[!链接]：https://juejin.cn/post/6844904105882697741

