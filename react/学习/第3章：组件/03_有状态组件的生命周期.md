# 生命周期的三个阶段

  ### 1.组件创建时（挂载阶段），页面加载时
  - (1)执行顺序：constructor()  -->  render()  -->  componentDidMount
    |          钩子函数         |          触发时机         |                        作用                     |
    |------**constructor**------|----创建组件时，最先执行---|------1.初始化state 2.为事件处理程序绑定this-----|
    |---**comonentWillMount**---|---组件即将挂载(DOM渲染)---|-------------------------------------------------|
    |---------**render**--------|----每次组件渲染都会触发---|---------渲染UI(**此时不能电泳setState()**)------|
    |---**comonentDidMount**----|--组件挂载(完成DOM渲染)后--|-------------1.发送网络请求 2.DOM操作------------|

  ### 2.更新时
  - (1)触发render()更新的条件：1.new Props 2.setState() 3.forceUpdated
  - (2)执行顺序：render() ---> componentDidUpdate
  - (3)如果直接在componentDidMount中调用setState更新状态，会导致递归更新，陷入render --> compoeentDidMount --> render的死循环
    |              钩子函数           |            触发时机       |    是否废弃   |                                   作用                                |
    |--**componentWillReceiveProps**--|----组件即将接受新的参数---|---------------|-----------------------------------------------------------------------|
    |----**shouldComponentUpdate**----|--组件挂载(完成DOM渲染)后--|------废弃-----|------1.发送网络请求 2.DOM操作3.**如果要setState必须在if条件中**-------|
    |----**componentWillUpdate**------|-------组件即将更新了------|------废弃-----|----------------------有机会拿到旧的props,state------------------------|
    |------------**render**-----------|----每次组件渲染都会触发---|---------------|----------------------------------渲染UI-------------------------------|
    |------**componentDidUpdate**-----|------组件已经更新了-------|---------------|------1.发送网络请求 2.DOM操作3.**如果要setState必须在if条件中**-------|
    |---**getSnapshotBeforeUpdate**---|-----组件即将更新之前------|---------------|------------------组件更新前获取组件旧数据信息的快照-------------------|
    ```js
      render(){
        return (
          <div>111</div>
        )
      }
      // 有机会拿到旧的props
      componentWillReceiveProps (props,state) {

      }
      componentWillUpdate (props,state) {

      }
      // shouldComponentUpdate使用场景：
      shouldComponentUpdate (new_props, new_state) {
         if (!new_props.show) return // 如果父组件传递的show为false，就不更新子组件
      }
      getSnapshotBeforeUpdate (prev_props, prev_state) {
        // 将旧的数据返回给componentDidUpdate生命周期
        return {
          data: {
            prev_props, prev_state
          }
        }
      }
      componentDidUpdate (pre) {
        // this.setState({})
        if (pre.count !== this.props.count) {
          this.setState()
        } // 比较更新前后的props是否相同来确定是否使用setState
      }
    ```

  ### 3.卸载时，组件从页面消失时
    |             钩子函数         |          触发时机         |                  作用                        |
    |-----------**render**---------|----每次组件渲染都会触发---|---------------渲染UI-------------------------|
    |---**comonentWillUnMount**----|---组件卸载(从页面中消失)--|------执行清理工作（比如:清理定时器等）-------|
    ```js
      componentDidMount(){
        setInterval(()=>{
          console.log('执行定时器')
        },1000)
      }
      comonentWillUnMount(){
        clearInterval()
      }
    ```

  ### 4.不常用的生命周期钩子函数

# 新旧生命周期对比