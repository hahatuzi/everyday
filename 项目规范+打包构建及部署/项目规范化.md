# 一：项目规范化范围
  - (1)文件结构,包括组件等命名以及书写位置规范
  - (2)代码规范，变量命名，代码书写空格，缩进换行等风格统一,eslint+prettier+stylelint
  - (3)提交规范，Commitlint或者husky，CICD通过调用脚本来实现校验触发

# 二：eslint
  ### 1.eslint安装使用步骤
  - **方式一：**
    - 第一步：**npm i eslint@9.X**,因为9.x有重大革新
    - 第二步：**package.json添加lint命令**。方便调试"scripts": { "lint": "eslint ."  }
    - 第三步：**新建eslint.config.js文件**添加eslint规范化脚本
    - 第四步：解决npm run lint时报错SyntaxError: Unexpected token 'export',package.json添加"type": "module"
    - 第五步：也可以忽略上述四步，直接使用eslint的js集成工具**@eslint/js**
    - 第六步：针对ts文件做校验，**npm i @typescript-eslint/parser**,如果不安装该插件的话npm run lint无法识别ts文件并进行校验
    - 第七步：在eslint.config.js中配置**@typescript-eslint/parser**
    - 第八步：针对vue文件进行校验,**npm i vue-eslint-parser**
    ```js
      import tsParser from '@typescript-eslint/parser'**
      import vueParser from 'vue-eslint-parser'
      export default{
        files:['**/*.ts'],
        ignores:['eslint.config.js'],
        languageOptions:{
          parser:vueParser, // 指定解析器
          parserOptions:{//  解析器的语法parser配置
            parser:tsParser,
            sourceType:"module"
          }
        },
        rules:{
          "no-unused-vars":"error", // 不允许声明没有使用的变量,off,warn,error
          "no-console":"error",// 不允许打印console
          "no-sparse-arrays":"error", // 不允许组数定义的时候有多余的逗号
          "no-undef":"error", // 不允许未声明的变量
          "no-unreachable":"error", // 不允许函数return后还写代码
          "no-dupe-keys":"error", // 不允许对象有重复的key
        }
      }
      // 或者使用以下代码，直接使用推荐的默认集成规范
      // import js from @eslint/js
      // export defualt [js.configs.recommended]
    ```
  - **方式二：**
    - 直接使用eslint的集成插件：**npm init @eslint/config@latest**，就会直接在项目中生成eslint.config.js，并自动安装集成工具@eslint/js
    ```js
      import js from "@eslint/js";
      import globals from "globals";
      import pluginVue from "eslint-plugin-vue";
      import { defineConfig } from "eslint/config";

      export default defineConfig([
        { files: ["**/*.{js,mjs,cjs,vue}"], plugins: { js }, extends: ["js/recommended"], languageOptions: { globals: globals.browser } },
        pluginVue.configs["flat/essential"],
      ]);
    ```

  ### 2.eslint文件常见规范解读--->转vue/vue3/项目/eslint文件解读.md
  [!参考文章]https://blog.csdn.net/qq_36973122/article/details/145433792
  [!参考项目]https://gitee.com/youlaiorg/vue3-element-admin.git
    ```js
    // https://eslint.org/docs/latest/use/configure/configuration-files-new

      import eslint from "@eslint/js";
      import pluginVue from "eslint-plugin-vue";
      import pluginTypeScript from "@typescript-eslint/eslint-plugin";
      import parserTypeScript from "@typescript-eslint/parser";
      import vueParser from "vue-eslint-parser";
      import globals from "globals";
      import configPrettier from "eslint-config-prettier";

      // 解析自动导入配置
      import fs from "node:fs";
      let autoImportGlobals = {};
      try {
        autoImportGlobals = JSON.parse(fs.readFileSync("./.eslintrc-auto-import.json", "utf-8")).globals || {};
      } catch (error) {
        // 文件不存在或解析错误时使用空对象
        console.warn("Could not load auto-import globals", error);
      }

      // Element Plus组件
      const elementPlusComponents = {
        // Element Plus 组件添加为全局变量，避免 no-undef 报错
        ElInput: "readonly",
        ElSelect: "readonly",
        ElSwitch: "readonly",
        ElMessage: "readonly",
        ElMessageBox: "readonly",
        ElNotification: "readonly",
        ElTree: "readonly",
      };

      export default [
        // 全局配置
        {
          // 指定要检查的文件
          files: ["**/*.js", "**/*.ts", "**/*.vue"],
          ignores: ["node_modules/**", "dist/**", "build/**"],
          languageOptions: {
            ecmaVersion: 2022,
            sourceType: "module",
            globals: {
              ...globals.browser, // 浏览器环境全局变量
              ...globals.node, // Node.js 环境全局变量
              ...autoImportGlobals, // 自动导入的 API 函数
              ...elementPlusComponents, // Element Plus 组件
              // 全局类型定义，解决 TypeScript 中定义但 ESLint 不识别的问题
              PageQuery: "readonly",
              PageResult: "readonly",
              OptionType: "readonly",
              ResponseData: "readonly",
              ExcelResult: "readonly",
              TagView: "readonly",
              AppSettings: "readonly",
              __APP_INFO__: "readonly",
            },
            parser: parserTypeScript,
            parserOptions: {
              sourceType: "module",
            },
          },
          rules: {
            // 全局规则
            "no-unused-vars": [
              "error",
              {
                vars: "all",
                args: "after-used",
                ignoreRestSiblings: true,
                argsIgnorePattern: "^_", // 忽略以下划线开头的参数
                varsIgnorePattern: "^[A-Z][A-Z0-9_]*$", // 忽略全大写的常量/枚举
              },
            ],
            // 禁用未定义变量检查，TypeScript 已处理类型检查
            "no-undef": "off",
          },
        },

        // 基础 JavaScript 配置
        eslint.configs.recommended,

        // Vue 配置
        {
          files: ["**/*.vue"],
          plugins: {
            vue: pluginVue,
          },
          languageOptions: {
            parser: vueParser,
            parserOptions: {
              ecmaVersion: 2022,
              sourceType: "module",
              parser: parserTypeScript,
            },
          },
          processor: pluginVue.processors[".vue"],
          rules: {
            "vue/multi-word-component-names": "off",
            "vue/no-v-html": "off",
            "vue/require-default-prop": "off",
            "vue/html-self-closing": [
              "error",
              {
                html: {
                  void: "always",
                  normal: "never",
                  component: "always",
                },
              },
            ],
            "vue/no-unused-vars": "off",
          },
        },

        // TypeScript 配置
        {
          files: ["**/*.ts", "**/*.tsx", "**/*.vue"],
          plugins: {
            "@typescript-eslint": pluginTypeScript,
          },
          rules: {
            "@typescript-eslint/no-explicit-any": "off",
            "@typescript-eslint/no-empty-function": "off",
            "@typescript-eslint/no-empty-object-type": "off",
            "@typescript-eslint/ban-ts-comment": "off",
            "@typescript-eslint/no-non-null-assertion": "off",
            "@typescript-eslint/no-unused-vars": [
              "error",
              {
                vars: "all",
                args: "after-used",
                ignoreRestSiblings: true,
                argsIgnorePattern: "^_", // 忽略以下划线开头的参数
                varsIgnorePattern: "^[A-Z][A-Z0-9_]*$", // 忽略全大写的常量/枚举
              },
            ],
          },
        },

        // CURD 组件配置
        {
          files: ["**/components/CURD/**/*.{ts,vue}"],
          rules: {
            "no-unused-vars": "off",
            "@typescript-eslint/no-unused-vars": "off",
          },
        },

        // Prettier 集成
        {
          rules: {
            ...configPrettier.rules,
          },
        },
      ];

    ```

  ### eslint自定义rules规则
    - 第一步：rule定义：针对需求编写一个rule,原理是通过ast，通过ast节点处理
      ```js
        // 规则的本质是一个对象，
        // 插件化体系中，这个对象的属性约束就是我们讲的插件化协议
        export const noChineseVars = {
          // 插件的元信息
          meta:{
            messages:{
              noChineseName:'不允许使用中文' // noChineseName对应Identifier中的messageId
            }
          },
          // 插件的入口,插件上下文
          create (context) {
            return {
              // 访问者模式，访问到某一个ast节点时就进行处理
              VariableDeclaration(node){
                console.log('VariableDeclaration',node);
              },
              VariableDeclarator(node){
                console.log(node);
              },
              Identifier(node){
                console.log(node);
                if (node.name == 'chinese') {
                  context.report({
                    node,
                    messageId:'noChineseName'
                  })
                }
              },
              Literal(node){
                console.log(node);
              },
            }
          }
        }
      ```
    - 第二步：定义plugins插件，将rule进行插件化，提供给外部使用
      ```js
        // 规则的本质是一个对象，
        // 插件化体系中，这个对象的属性约束就是我们讲的插件化协议
        export const noChineseVars = {
          // 插件的元信息
          meta:{
            messages:{
              noChineseName:'不允许使用中文' // noChineseName对应Identifier中的messageId
            }
          },
          // 插件的入口,插件上下文
          create (context) {
            return {
              // 访问者模式，访问到某一个ast节点时就进行处理
              VariableDeclaration(node){
                console.log('VariableDeclaration',node);
              },
              VariableDeclarator(node){
                console.log(node);
              },
              Identifier(node){
                console.log(node);
                if (node.name == 'chinese') {
                  context.report({
                    node,
                    messageId:'noChineseName'
                  })
                }
              },
              Literal(node){
                console.log(node);
              },
            }
          }
        }

      ```
    - 第三步：将插件引入到eslint配置文件中进行使用
      ```js
        import {eslintChinesePlugin} from './eslint/plugins/eslint-plugin-chinese.js'
        export default{
          files:['**/*.ts','**/*.vue'],
          ignores:['eslint.config.js'],
          plugins:{
            'chinese':eslintChinesePlugin // 插件注册，插件的名称就是规则的作用域rules:{'chinese/no-chinese-vars':"error"}
          },
          rules:{
            "chinese/no-chinese-vars":"error"
          }
        }
      ```
 
